# TypeScript Duplicate Detector 任务规则

这是一个为 TypeScript 重复命名检测工具项目定义自动化任务的文件。当我被要求执行特定任务时，我会参考这里的步骤。

---

## 任务 1: 提交代码

**目标**: 结合本次修改，生成符合项目规范的提交信息，并在确认后提交代码，最后推送到远程分支。

**执行步骤**:

1.  运行 `git status` 和 `git diff HEAD` 分析暂存区和工作区的代码变更。
2.  根据代码变更，使用项目的 Conventional Commits 规范草拟提交信息。可以使用 `pnpm commit` 进行交互式提交，或手动编写：

    ```
    <type>(<scope>): <subject>

    ### 🚀 变更概述

    [这里填写对变更的简要描述，说明变更的目的和背景。]

    ### 主要变更

    - 🎯 [详细说明第一个主要变更点]
    - 🎯 [详细说明第二个主要变更点]
    - 🎯 [其他相关变更]
    ```

    - **type**: 提交类型 (feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert, wip, deps, patch, minor, major)
    - **scope**: 可选的作用域 (core, cli, detector, config, test, docs, build)
    - **subject**: 简短的变更描述

3.  向用户展示草拟的提交信息，并请求确认。
4.  在用户确认后，执行 `git add .` 将所有更改添加到暂存区。
5.  执行提交命令（推荐使用 `pnpm commit` 进行交互式提交）。
6.  执行 `git push` 将代码推送到当前的远程分支。

---

## 任务 2: 触发 Patch 版本发布

**目标**: 通过提交 patch 类型的 commit 来触发远程 CI 自动发布补丁版本，用于 bug 修复。

**执行步骤**:

1.  运行 `git status --porcelain` 检查是否存在未提交的变更。
2.  如果存在未提交的变更，则提示并执行 **任务 1: 提交代码** 的流程。
3.  运行 `pnpm lint` 和 `pnpm test:run` 确保代码质量和测试通过。
4.  向用户确认是否要触发补丁 (Patch) 版本发布。
5.  在用户确认后，使用 `pnpm commit` 创建 `patch:` 类型的提交：
    - 选择 "🔧 patch: 补丁版本发布 (0.0.x) - 修复 bug"
    - 填写具体的修复内容描述
6.  执行 `git push` 推送到远程仓库。
7.  GitHub Actions 会自动检测到 `patch:` 提交并触发发布流程（构建、测试、版本更新、发布）。
8.  向用户报告代码已推送，远程 CI 将自动处理版本发布。

---

## 任务 3: 触发 Major 版本发布

**目标**: 通过提交 major 类型的 commit 来触发远程 CI 自动发布主版本，用于破坏性变更。

**执行步骤**:

1.  运行 `git status --porcelain` 检查是否存在未提交的变更。
2.  如果存在未提交的变更，则提示并执行 **任务 1: 提交代码** 的流程。
3.  运行 `pnpm lint` 和 `pnpm test:run` 确保代码质量和测试通过。
4.  向用户确认是否要触发主 (Major) 版本发布，并提醒这是破坏性变更。
5.  在用户确认后，使用 `pnpm commit` 创建 `major:` 类型的提交：
    - 选择 "💥 major: 主要版本发布 (x.0.0) - 破坏性变更"
    - 详细描述破坏性变更内容和迁移指南
6.  执行 `git push` 推送到远程仓库。
7.  GitHub Actions 会自动检测到 `major:` 提交并触发发布流程（构建、测试、版本更新、发布）。
8.  向用户报告代码已推送，远程 CI 将自动处理版本发布，并提醒准备迁移文档。

---

## 任务 4: 触发 Minor 版本发布

**目标**: 通过提交 minor 类型的 commit 来触发远程 CI 自动发布次版本，用于新功能添加。

**执行步骤**:

1.  运行 `git status --porcelain` 检查是否存在未提交的变更。
2.  如果存在未提交的变更，则提示并执行 **任务 1: 提交代码** 的流程。
3.  运行 `pnpm lint` 和 `pnpm test:run` 确保代码质量和测试通过。
4.  向用户确认是否要触发次 (Minor) 版本发布。
5.  在用户确认后，使用 `pnpm commit` 创建 `minor:` 类型的提交：
    - 选择 "🎯 minor: 次要版本发布 (0.x.0) - 新功能，向后兼容"
    - 详细描述新增的功能特性
6.  执行 `git push` 推送到远程仓库。
7.  GitHub Actions 会自动检测到 `minor:` 提交并触发发布流程（构建、测试、版本更新、发布）。
8.  向用户报告代码已推送，远程 CI 将自动处理版本发布。

---

## 任务 5: 运行测试和质量检查

**目标**: 执行完整的代码质量检查和测试套件。

**执行步骤**:

1.  运行 `pnpm lint` 执行 ESLint 代码检查。
2.  运行 `pnpm test:run` 执行测试套件并生成覆盖率报告。
3.  运行 `pnpm build` 确保项目可以正常构建。
4.  检查测试覆盖率是否达到项目要求（当前目标 >75%）。
5.  如果发现问题，向用户报告并建议修复方案。
6.  如果所有检查通过，向用户报告项目状态良好。

---

## 任务 6: 开发环境设置

**目标**: 帮助设置和验证开发环境。

**执行步骤**:

1.  检查 Node.js 版本是否 >= 18。
2.  检查是否安装了 pnpm（推荐的包管理器）。
3.  运行 `pnpm install` 安装项目依赖。
4.  运行 `pnpm build` 验证构建流程。
5.  运行 `pnpm dev` 测试开发模式。
6.  向用户说明常用的开发命令和工作流程。

---

## 任务 7: 生成项目报告

**目标**: 生成项目的当前状态报告。

**执行步骤**:

1.  运行 `git log --oneline -10` 查看最近的提交历史。
2.  运行 `pnpm test:run` 获取测试覆盖率数据。
3.  检查 package.json 中的版本信息和依赖状态。
4.  运行 `git status` 检查工作区状态。
5.  生成包含以下信息的报告：
    - 项目基本信息（名称、版本、描述）
    - 测试覆盖率统计
    - 最近的代码变更
    - 依赖状态
    - 待办事项和建议

---
